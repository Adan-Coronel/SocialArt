extends layout

block content
  link(rel="stylesheet", href="/album.css")
  link(rel="stylesheet", href="/reacciones.css")
  body(data-usuario-logueado=usuarioLogueado ? usuarioLogueado.idUser : null)
  .album-container
    .album-header
      h1 √Ålbum "#{album.titulo}"
      if esAlbumCompartido
        .album-compartido-info
          p.info-compartido üì§ Este es un √°lbum compartido con las im√°genes de #{album.propietario.nombre}
      if album.Tags && album.Tags.length
        .album-tags
          p Tags: 
          each tag in album.Tags
            span.tag-badge #{tag.nombreTag}
      if album.propietario
        .propietario-info
          p Creado por: 
            a.propietario-link(href=`/perfil/${album.propietario.idUser}`) #{album.propietario.nombre}
          small Hace #{new Date(album.created_at).toLocaleDateString()}
    if usuarioLogueado && album.user_id === usuarioLogueado.idUser && !esAlbumCompartido
      .album-actions
        a.btn-editar(href=`/albums/${album.idAlbum}/editar`) ‚úèÔ∏è Editar √°lbum
    if !album.is_public
          a.btn-visibilidad(href=`/visibilidad/${album.idAlbum}`) üëÅÔ∏è Configurar visibilidad
    .imagenes-section
      h2 Im√°genes
      if esAlbumCompartido
        p.info-compartido-imagenes Estas son las im√°genes que #{album.propietario.nombre} ha compartido contigo.
      if imagenes.length
        each img in imagenes
          .imagen-item(data-image-id=img.idImage, id=`imagen-${img.idImage}`)
            .imagen-container
              img.imagen-principal(src=img.url, alt=img.caption || 'Imagen del √°lbum')
              if img.caption
                p.imagen-caption= img.caption
            .reacciones-container
              if usuarioLogueado
                button.btn-reaccion(onclick=`toggleReaccion(${img.idImage})`)
                  | ‚ù§Ô∏è
                span.contador-reacciones
              else
                span.login-para-reaccionar Inicia sesi√≥n para reaccionar
            .comentarios-section
              .comentarios-header
                h4 Comentarios
                if usuarioLogueado
                  .comentario-form
                    textarea.comentario-input(placeholder="Escribe un comentario...", rows="2")
                    button.btn-comentar(onclick=`enviarComentario(${img.idImage})`) Comentar
                else
                  p.login-para-comentar Inicia sesi√≥n para comentar
              
              .comentarios-lista(id=`comentarios-${img.idImage}`)
      else
        if esAlbumCompartido
          p.sin-imagenes #{album.propietario.nombre} a√∫n no ha compartido im√°genes contigo o no tienes permisos para verlas.
        else
          p.sin-imagenes No hay im√°genes todav√≠a en este √°lbum.
  .modal-alerta#modalAlerta
    .modal-alerta-fondo
    .modal-alerta-contenido
      .modal-alerta-header
        h3.modal-alerta-titulo Mensaje
        button.modal-alerta-cerrar(onclick="cerrarModalAlerta()") √ó
      .modal-alerta-body
        p#modalAlertaMensaje
      .modal-alerta-footer
        button.modal-alerta-btn-ok(onclick="cerrarModalAlerta()") Aceptar
  script(src="/album.js")
  script(src="/reacciones.js")
  script(src="/modal-alerta.js")